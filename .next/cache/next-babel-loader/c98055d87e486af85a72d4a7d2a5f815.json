{"ast":null,"code":"var _jsxFileName = \"/home/dhaneshen/Documents/booktrade/unibooktrade/pages/testing.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport { useRouter } from 'next/router';\nimport { withRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport { Credentials } from 'aws-sdk';\nconst contact = withRouter(({\n  router: {\n    query: {\n      name,\n      id,\n      firstname,\n      bookID,\n      bookOwnerName,\n      ownerFirstName,\n      bookOwnerID,\n      bookTitle,\n      userEmail,\n      ownerEmail\n    }\n  },\n  books\n}) => {\n  const {\n    0: defaultText,\n    1: setDefaultText\n  } = useState('Hi there ' + ownerFirstName + ', I am interested in your book, \"' + bookTitle + '\"!');\n  const {\n    0: booklist,\n    1: setBooklist\n  } = useState([]);\n  /* Deal with AWS SES */\n  // Load the AWS SDK for Node.js\n\n  var AWS = require('aws-sdk'); //AWS.config.loadFromPath('./config.json');\n  // Set the region \n\n  /*\n  AWS.config.update({\n      region: 'ca-central-1'\n      \n  });\n  */\n\n\n  AWS.config.update({\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\n    region: \"us-east-2\"\n  });\n  console.log('email is ' + ownerEmail); // Create the promise and SES service object\n  //var sendPromise = new AWS.SES({apiVersion: '2010-12-01'}).sendBulkTemplatedEmail(params).promise();\n\n  /* End of AWS SES */\n  // Assign constant names to values obtained from 'booklist' via withRouter\n\n  useEffect(() => {\n    const userName = name;\n    const userID = id;\n    const userFirstname = firstname;\n    setBooklist(books);\n    console.log('booklist is');\n    console.log(booklist);\n  }); // Redirect to myprofile\n\n  const myProfile = () => {\n    Router.push({\n      pathname: '/myprofile',\n      query: {\n        mytitle: '',\n        author: '',\n        name: name,\n        id: id,\n        firstname: firstname,\n        userEmail: userEmail\n      }\n    });\n  }; // Redirect to new for creating new post\n\n\n  const myBooks = () => {\n    Router.push({\n      pathname: '/new',\n      query: {\n        id: id,\n        name: name,\n        firstname: firstname,\n        userEmail: userEmail\n      }\n    });\n  }; // Redirect posts\n\n\n  const Search = () => {\n    Router.push({\n      pathname: '/posts',\n      query: {\n        id: id,\n        name: name,\n        firstname: firstname,\n        userEmail: userEmail\n      }\n    });\n  }; // Handle text in textArea\n\n\n  const handleChange = e => {\n    const value = e.target.value;\n    setDefaultText(value);\n  }; //Send email \n\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    /*\n    const From = 'booksexchnagemessenger@gmail.com';\n    const To = 'dan.moonian@gmail.com';\n     console.log('Text: '+ defaultText)\n    \n    console.log('sending mail');\n         const sender = \"booksexchangemessenger@gmail.com\"\n        const recipient = ownerEmail\n        //const configuration_set = \"ConfigSet\"\n        const subject = \"Amazon SES test\"\n        const body_text = defaultText\n        const body_html = '<html><body><p>'+body_text+'</p></body></html>'\n        const charset = \"UTF-8\"\n        var ses = new AWS.SES();\n          // Specify the parameters to pass to the API.\n        var params = { \n            Source: sender, \n            Destination: { \n              ToAddresses: [\n                recipient \n              ],\n            },\n            Message: {\n              Subject: {\n                Data: subject,\n                Charset: charset\n              },\n              Body: {\n                Text: {\n                  Data: body_text,\n                  Charset: charset \n                },\n                Html: {\n                  Data: body_html,\n                  Charset: charset\n                }\n              }\n            },\n            //ConfigurationSetName: configuration_set\n          };\n        ses.sendEmail(params, function(err, data) {\n        // If something goes wrong, print an error message.\n        if(err) {\n          console.log(err.message);\n        } else {\n          console.log(\"Email sent! Message ID: \", data.MessageId);\n          console.log('email sent to '+ownerEmail)\n        }\n      });\n      */\n    //Send mail using mailto function\n  }; // Display on screen\n\n\n  return __jsx(\"div\", {\n    className: \"contact-page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"book-greeting\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"greeting-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"icon-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }, __jsx(Link, {\n    href: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 21\n    }\n  }, __jsx(\"img\", {\n    src: \"/icons/sign-out.png\",\n    alt: \"my image\",\n    className: \"my-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: \"my-icon-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 21\n    }\n  }, __jsx(\"img\", {\n    src: \"/icons/four-square.png\",\n    alt: \"my books\",\n    className: \"my-icon\",\n    onClick: myProfile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }), __jsx(\"img\", {\n    src: \"/icons/plus.png\",\n    alt: \"Add book\",\n    className: \"my-icon\",\n    onClick: myBooks,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 21\n    }\n  }), __jsx(\"img\", {\n    src: \"/icons/search.png\",\n    alt: \"Search\",\n    className: \"my-icon\",\n    onClick: Search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      marginTop: '4%',\n      padding: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 17\n    }\n  }, __jsx(\"p\", {\n    style: {\n      fontSize: '18px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 17\n    }\n  }, \"This is a collection of all the books matching your search\", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 17\n    }\n  }), __jsx(\"span\", {\n    style: {\n      fontSize: '16px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 22\n    }\n  }, \"Once you find the one you want, get in contact with the owner.\"))))), __jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 9\n    }\n  }, \"Send mail\"), __jsx(\"a\", {\n    href: \"mailto:dan.moonian@gmail.com\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 9\n    }\n  }, \"Email Us\"), __jsx(\"div\", {\n    className: \"book-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 1\n    }\n  }, booklist.map(book => {\n    //var imageBase64 = book.imageFront.contentType;\n    var imageData;\n    var base64data;\n\n    if (book.imageFront) {\n      imageData = book.imageFront.data;\n    } else {\n      console.log('no image');\n      imageData = '';\n    }\n\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 32\n      }\n    }, __jsx(\"div\", {\n      key: book._id,\n      className: \"bookInfo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 29\n      }\n    }, __jsx(\"div\", {\n      className: \"contact-bookinfo-pic\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 33\n      }\n    }, __jsx(\"img\", {\n      src: imageData,\n      style: {\n        width: '200px',\n        height: '200px',\n        borderRadius: '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 37\n      }\n    })), __jsx(\"div\", {\n      className: \"contact-bookinfo-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 33\n      }\n    }, __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 37\n      }\n    }, \"Title: \", __jsx(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 47\n      }\n    }, book.title)), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 37\n      }\n    }, \"Author: \", __jsx(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 48\n      }\n    }, book.author)), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 37\n      }\n    }, \"Owned by \", __jsx(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 49\n      }\n    }, bookOwnerName)))));\n  })), __jsx(\"form\", {\n    style: {\n      width: '90%',\n      marginTop: '7%',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 9\n    }\n  }, __jsx(\"textarea\", {\n    type: \"text\",\n    id: \"lname\",\n    name: \"lname\",\n    value: defaultText,\n    onChange: handleChange,\n    className: \"contact-textBox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 13\n    }\n  }), __jsx(\"button\", {\n    style: {\n      marginTop: '4%'\n    },\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 13\n    }\n  }, \"Send message\")));\n}); // Get content from database \n\ncontact.getInitialProps = async ctx => {\n  console.log('ctx is');\n  console.log(ctx.query.bookOwnerID);\n  console.log(ctx.query.bookID);\n\n  try {\n    //const res = await fetch('https://unibooktrade.vercel.app/api/books', {\n    const res = await fetch('http://localhost:3000/api/books', {\n      headers: {\n        title: '',\n        author: '',\n        id: ctx.query.bookOwnerID,\n        bookID: ctx.query.bookID\n      }\n    });\n    const {\n      data\n    } = await res.json();\n    return {\n      books: data\n    };\n  } catch (error) {\n    return {\n      books: []\n    };\n  }\n};\n\nexport default contact;","map":{"version":3,"sources":["/home/dhaneshen/Documents/booktrade/unibooktrade/pages/testing.js"],"names":["React","useState","useEffect","Link","Router","useRouter","withRouter","fetch","Credentials","contact","router","query","name","id","firstname","bookID","bookOwnerName","ownerFirstName","bookOwnerID","bookTitle","userEmail","ownerEmail","books","defaultText","setDefaultText","booklist","setBooklist","AWS","require","config","update","accessKeyId","process","env","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","region","console","log","userName","userID","userFirstname","myProfile","push","pathname","mytitle","author","myBooks","Search","handleChange","e","value","target","handleSubmit","preventDefault","marginTop","padding","fontSize","map","book","imageData","base64data","imageFront","data","_id","width","height","borderRadius","title","alignItems","justifyContent","getInitialProps","ctx","res","headers","json","error"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AAEA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,UAAT,QAA2B,aAA3B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,SAASC,WAAT,QAA4B,SAA5B;AAKA,MAAMC,OAAO,GAAGH,UAAU,CAAC,CAAC;AAAEI,EAAAA,MAAM,EAAG;AAAEC,IAAAA,KAAK,EAAC;AAACC,MAAAA,IAAD;AAAOC,MAAAA,EAAP;AAAWC,MAAAA,SAAX;AAAsBC,MAAAA,MAAtB;AAA8BC,MAAAA,aAA9B;AAA6CC,MAAAA,cAA7C;AAA4DC,MAAAA,WAA5D;AAAyEC,MAAAA,SAAzE;AAAoFC,MAAAA,SAApF;AAA+FC,MAAAA;AAA/F;AAAR,GAAX;AAAgIC,EAAAA;AAAhI,CAAD,KAA6I;AACpK,QAAM;AAAA,OAACC,WAAD;AAAA,OAAcC;AAAd,MAAgCvB,QAAQ,CAAC,cAAYgB,cAAZ,GAA2B,mCAA3B,GAA+DE,SAA/D,GAAyE,IAA1E,CAA9C;AACA,QAAM;AAAA,OAACM,QAAD;AAAA,OAAWC;AAAX,MAA0BzB,QAAQ,CAAC,EAAD,CAAxC;AAGA;AACA;;AAEA,MAAI0B,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAjB,CARoK,CAUpK;AAEA;;AACA;;;;;;;;AAQDD,EAAAA,GAAG,CAACE,MAAJ,CAAWC,MAAX,CAAkB;AACjBC,IAAAA,WAAW,EAAEC,OAAO,CAACC,GAAR,CAAYC,iBADR;AAEjBC,IAAAA,eAAe,EAAEH,OAAO,CAACC,GAAR,CAAYG,qBAFZ;AAGjBC,IAAAA,MAAM,EAAE;AAHS,GAAlB;AAQCC,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAYlB,UAAxB,EA7BoK,CAqCpK;AACA;;AAEA;AAOA;;AACAnB,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMsC,QAAQ,GAAG5B,IAAjB;AACA,UAAM6B,MAAM,GAAG5B,EAAf;AACA,UAAM6B,aAAa,GAAG5B,SAAtB;AAEAY,IAAAA,WAAW,CAACJ,KAAD,CAAX;AACAgB,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYd,QAAZ;AAEH,GATQ,CAAT,CAhDoK,CA2DpK;;AACA,QAAMkB,SAAS,GAAG,MAAM;AACpBvC,IAAAA,MAAM,CAACwC,IAAP,CAAY;AACRC,MAAAA,QAAQ,EAAE,YADF;AAERlC,MAAAA,KAAK,EAAE;AACCmC,QAAAA,OAAO,EAAE,EADV;AAECC,QAAAA,MAAM,EAAE,EAFT;AAGCnC,QAAAA,IAAI,EAAEA,IAHP;AAICC,QAAAA,EAAE,EAAEA,EAJL;AAKCC,QAAAA,SAAS,EAAEA,SALZ;AAMCM,QAAAA,SAAS,EAACA;AANX;AAFC,KAAZ;AAYH,GAbD,CA5DoK,CA2EpK;;;AACA,QAAM4B,OAAO,GAAG,MAAM;AAClB5C,IAAAA,MAAM,CAACwC,IAAP,CAAY;AACRC,MAAAA,QAAQ,EAAE,MADF;AAERlC,MAAAA,KAAK,EAAE;AACCE,QAAAA,EAAE,EAAEA,EADL;AAECD,QAAAA,IAAI,EAAEA,IAFP;AAGCE,QAAAA,SAAS,EAAEA,SAHZ;AAICM,QAAAA,SAAS,EAACA;AAJX;AAFC,KAAZ;AAUH,GAXD,CA5EoK,CAyFpK;;;AACA,QAAM6B,MAAM,GAAG,MAAM;AACjB7C,IAAAA,MAAM,CAACwC,IAAP,CAAY;AACRC,MAAAA,QAAQ,EAAE,QADF;AAERlC,MAAAA,KAAK,EAAE;AACCE,QAAAA,EAAE,EAAEA,EADL;AAECD,QAAAA,IAAI,EAAEA,IAFP;AAGCE,QAAAA,SAAS,EAAEA,SAHZ;AAICM,QAAAA,SAAS,EAACA;AAJX;AAFC,KAAZ;AAUH,GAXD,CA1FoK,CAuGpK;;;AACA,QAAM8B,YAAY,GAAIC,CAAD,IAAO;AACxB,UAAMC,KAAK,GAAGD,CAAC,CAACE,MAAF,CAASD,KAAvB;AAEA5B,IAAAA,cAAc,CAAC4B,KAAD,CAAd;AACH,GAJD,CAxGoK,CA8GpK;;;AACA,QAAME,YAAY,GAAIH,CAAD,IAAO;AACxBA,IAAAA,CAAC,CAACI,cAAF;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDE;AAKL,GAjED,CA/GoK,CAkLpK;;;AACA,SACI;AAAK,IAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACQ,MAAC,IAAD;AAAM,IAAA,IAAI,EAAC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,GAAG,EAAC,qBAAT;AAA+B,IAAA,GAAG,EAAC,UAAnC;AAA8C,IAAA,SAAS,EAAC,SAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADR,EAKQ;AAAK,IAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA;AAAK,IAAA,GAAG,EAAC,wBAAT;AAAkC,IAAA,GAAG,EAAC,UAAtC;AAAiD,IAAA,SAAS,EAAC,SAA3D;AAAqE,IAAA,OAAO,EAAEZ,SAA9E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,EAGA;AAAK,IAAA,GAAG,EAAC,iBAAT;AAA2B,IAAA,GAAG,EAAC,UAA/B;AAA0C,IAAA,SAAS,EAAC,SAApD;AAA8D,IAAA,OAAO,EAAEK,OAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHA,EAIA;AAAK,IAAA,GAAG,EAAC,mBAAT;AAA6B,IAAA,GAAG,EAAC,QAAjC;AAA0C,IAAA,SAAS,EAAC,SAApD;AAA8D,IAAA,OAAO,EAAEC,MAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJA,CALR,CADA,EAiBI;AAAK,IAAA,KAAK,EAAE;AAAEO,MAAAA,SAAS,EAAC,IAAZ;AAAkBC,MAAAA,OAAO,EAAC;AAA1B,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEA;AAAG,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAC;AAAX,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mEAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFA,EAEK;AAAM,IAAA,KAAK,EAAE;AAAEA,MAAAA,QAAQ,EAAE;AAAZ,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sEAFL,CAFA,CAjBJ,CADA,CADJ,EA8BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBA9BA,EA+BA;AAAG,IAAA,IAAI,EAAC,8BAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBA/BA,EAkCR;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACSjC,QAAQ,CAACkC,GAAT,CAAcC,IAAI,IAAI;AAGf;AACA,QAAIC,SAAJ;AACA,QAAIC,UAAJ;;AAEA,QAAIF,IAAI,CAACG,UAAT,EAAoB;AAEhBF,MAAAA,SAAS,GAAGD,IAAI,CAACG,UAAL,CAAgBC,IAA5B;AAEH,KAJD,MAKI;AACA1B,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACAsB,MAAAA,SAAS,GAAC,EAAV;AACH;;AAGO,WACO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIH;AAAK,MAAA,GAAG,EAAED,IAAI,CAACK,GAAf;AAAoB,MAAA,SAAS,EAAC,UAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,GAAG,EAAEJ,SAAV;AAAsB,MAAA,KAAK,EAAE;AAAEK,QAAAA,KAAK,EAAC,OAAR;AAAiBC,QAAAA,MAAM,EAAC,OAAxB;AAAiCC,QAAAA,YAAY,EAAC;AAA9C,OAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,EAKI;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIR,IAAI,CAACS,KAAT,CAAV,CADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIT,IAAI,CAACb,MAAT,CAAX,CAFJ,EAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAI/B,aAAJ,CAAZ,CAHJ,CALJ,CAJG,CADP;AAuBP,GAzCR,CADT,CAlCQ,EAqFA;AAAM,IAAA,KAAK,EAAE;AAAEkD,MAAAA,KAAK,EAAC,KAAR;AAAeV,MAAAA,SAAS,EAAC,IAAzB;AAA+Bc,MAAAA,UAAU,EAAC,QAA1C;AAAoDC,MAAAA,cAAc,EAAC;AAAnE,KAAb;AAA6F,IAAA,QAAQ,EAAEjB,YAAvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAU,IAAA,IAAI,EAAC,MAAf;AACI,IAAA,EAAE,EAAC,OADP;AAEI,IAAA,IAAI,EAAC,OAFT;AAGI,IAAA,KAAK,EAAG/B,WAHZ;AAII,IAAA,QAAQ,EAAE2B,YAJd;AAKI,IAAA,SAAS,EAAC,iBALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAQI;AAAQ,IAAA,KAAK,EAAE;AAAEM,MAAAA,SAAS,EAAE;AAAb,KAAf;AAAoC,IAAA,SAAS,EAAC,iBAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBARJ,CArFA,CADJ;AAoGH,CAvRyB,CAA1B,C,CA0RA;;AACA/C,OAAO,CAAC+D,eAAR,GAA0B,MAAOC,GAAP,IAAc;AACpCnC,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACAD,EAAAA,OAAO,CAACC,GAAR,CAAYkC,GAAG,CAAC9D,KAAJ,CAAUO,WAAtB;AACAoB,EAAAA,OAAO,CAACC,GAAR,CAAYkC,GAAG,CAAC9D,KAAJ,CAAUI,MAAtB;;AAEA,MAAI;AAEA;AACI,UAAM2D,GAAG,GAAG,MAAMnE,KAAK,CAAC,iCAAD,EAAoC;AACvDoE,MAAAA,OAAO,EAAE;AACLN,QAAAA,KAAK,EAAE,EADF;AAELtB,QAAAA,MAAM,EAAE,EAFH;AAGLlC,QAAAA,EAAE,EAAE4D,GAAG,CAAC9D,KAAJ,CAAUO,WAHT;AAILH,QAAAA,MAAM,EAAE0D,GAAG,CAAC9D,KAAJ,CAAUI;AAJb;AAD8C,KAApC,CAAvB;AAQA,UAAM;AAAEiD,MAAAA;AAAF,QAAW,MAAMU,GAAG,CAACE,IAAJ,EAAvB;AAGD,WAAM;AAAEtD,MAAAA,KAAK,EAAC0C;AAAR,KAAN;AAEH,GAhBJ,CAgBK,OAAOa,KAAP,EAAc;AAEf,WAAO;AAAEvD,MAAAA,KAAK,EAAE;AAAT,KAAP;AAEA;AAEN,CA3BF;;AA6BA,eAAeb,OAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\n\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport { useRouter } from 'next/router';\nimport { withRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport { Credentials } from 'aws-sdk';\n\n\n\n\nconst contact = withRouter(({ router:  { query:{name, id, firstname, bookID, bookOwnerName, ownerFirstName,bookOwnerID, bookTitle, userEmail, ownerEmail}}, books} ) => {\n    const [defaultText, setDefaultText] = useState('Hi there '+ownerFirstName+', I am interested in your book, \"'+bookTitle+'\"!');\n    const [booklist, setBooklist] = useState([]);\n\n\n    /* Deal with AWS SES */\n    // Load the AWS SDK for Node.js\n    \n    var AWS = require('aws-sdk');\n\n    //AWS.config.loadFromPath('./config.json');\n\n    // Set the region \n    /*\n    AWS.config.update({\n        region: 'ca-central-1'\n        \n    });\n    */\n\n\n   AWS.config.update({\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\n    region: \"us-east-2\"    \n});\n\n\n\n    console.log('email is '+ownerEmail)\n\n\n\n\n    \n  \n  \n    // Create the promise and SES service object\n    //var sendPromise = new AWS.SES({apiVersion: '2010-12-01'}).sendBulkTemplatedEmail(params).promise();\n\n    /* End of AWS SES */\n  \n\n\n\n\n\n    // Assign constant names to values obtained from 'booklist' via withRouter\n    useEffect(() => {\n        const userName = name;\n        const userID = id;\n        const userFirstname = firstname;\n\n        setBooklist(books)\n        console.log('booklist is')\n        console.log(booklist)\n\n    })\n\n    // Redirect to myprofile\n    const myProfile = () => {\n        Router.push({\n            pathname: '/myprofile',\n            query: { \n                    mytitle: '',\n                    author: '',\n                    name: name,\n                    id: id,\n                    firstname: firstname,\n                    userEmail:userEmail\n                    \n            }\n        });\n    }\n\n    // Redirect to new for creating new post\n    const myBooks = () => {\n        Router.push({\n            pathname: '/new',\n            query: { \n                    id: id,\n                    name: name,\n                    firstname: firstname,\n                    userEmail:userEmail\n                    \n            }\n        });\n    }\n\n    // Redirect posts\n    const Search = () => {\n        Router.push({\n            pathname: '/posts',\n            query: { \n                    id: id,\n                    name: name,\n                    firstname: firstname,\n                    userEmail:userEmail\n                    \n            }\n        });\n    }\n\n    // Handle text in textArea\n    const handleChange = (e) => { \n        const value = e.target.value;\n\n        setDefaultText(value);\n    }\n\n    //Send email \n    const handleSubmit = (e) => { \n        e.preventDefault();\n\n        /*\n        const From = 'booksexchnagemessenger@gmail.com';\n        const To = 'dan.moonian@gmail.com';\n\n        console.log('Text: '+ defaultText)\n        \n        console.log('sending mail');\n\n\n           const sender = \"booksexchangemessenger@gmail.com\"\n            const recipient = ownerEmail\n            //const configuration_set = \"ConfigSet\"\n            const subject = \"Amazon SES test\"\n            const body_text = defaultText\n            const body_html = '<html><body><p>'+body_text+'</p></body></html>'\n            const charset = \"UTF-8\"\n            var ses = new AWS.SES();\n\n\n            // Specify the parameters to pass to the API.\n            var params = { \n                Source: sender, \n                Destination: { \n                  ToAddresses: [\n                    recipient \n                  ],\n                },\n                Message: {\n                  Subject: {\n                    Data: subject,\n                    Charset: charset\n                  },\n                  Body: {\n                    Text: {\n                      Data: body_text,\n                      Charset: charset \n                    },\n                    Html: {\n                      Data: body_html,\n                      Charset: charset\n                    }\n                  }\n                },\n                //ConfigurationSetName: configuration_set\n              };\n\n           ses.sendEmail(params, function(err, data) {\n            // If something goes wrong, print an error message.\n            if(err) {\n              console.log(err.message);\n            } else {\n              console.log(\"Email sent! Message ID: \", data.MessageId);\n              console.log('email sent to '+ownerEmail)\n            }\n          });\n          */\n\n          //Send mail using mailto function\n\n\n\n\n    }\n\n    // Display on screen\n    return(\n        <div className='contact-page'>\n            <div className='book-greeting'>\n            <div className='greeting-text'>\n            <div className='icon-box'>\n                    <Link href='/'>\n                        <img src=\"/icons/sign-out.png\" alt=\"my image\" className='my-icon'/>\n                    </Link>\n                    \n                    <div className='my-icon-end'>\n                    <img src=\"/icons/four-square.png\" alt=\"my books\" className='my-icon' onClick={myProfile}/>\n                    \n                    <img src=\"/icons/plus.png\" alt=\"Add book\" className='my-icon' onClick={myBooks}/>\n                    <img src=\"/icons/search.png\" alt=\"Search\" className='my-icon' onClick={Search}/>\n                    \n                    </div>\n                    \n                </div>\n\n\n                <div style={{ marginTop:'4%', padding:'10px' }}>\n                    \n                <p style={{ fontSize:'18px' }}>This is a collection of all the books matching your search \n                \n                <br/><span style={{ fontSize: '16px' }}>Once you find the one you want, get in contact with the owner.</span></p>\n                \n                </div>\n            </div>\n            \n        </div>\n\n        <h1>Send mail</h1>\n        <a href=\"mailto:dan.moonian@gmail.com\">Email Us</a>\n\n\n<div className='book-list'>\n        {booklist.map( book => {\n\n                \n                //var imageBase64 = book.imageFront.contentType;\n                var imageData;\n                var base64data;\n    \n                if (book.imageFront){\n                    \n                    imageData = book.imageFront.data;\n    \n                }\n                else{\n                    console.log('no image');\n                    imageData='';\n                }\n\n\n                        return (\n                               <div>\n                            \n                            \n                            \n                            <div key={book._id} className='bookInfo'>\n                                <div className='contact-bookinfo-pic'>\n                                    <img src={imageData}  style={{ width:'200px', height:'200px', borderRadius:'20px'}}/>\n\n                                </div>\n                                <div className='contact-bookinfo-text'>\n                                    <p>Title: <b>{book.title}</b></p>\n                                    <p>Author: <b>{book.author}</b></p>\n                                    <p>Owned by <b>{bookOwnerName}</b></p>\n                                </div>\n                                \n                            </div>\n    \n                            </div>\n                            \n                        )\n                        \n                    \n                }\n                \n                \n                )}\n                </div>\n\n        \n\n\n        <form style={{ width:'90%', marginTop:'7%', alignItems:'center', justifyContent:'center' }}  onSubmit={handleSubmit}>\n            <textarea type=\"text\" \n                id=\"lname\" \n                name=\"lname\" \n                value= {defaultText}\n                onChange={handleChange}\n                className='contact-textBox'\n                />\n            <button style={{ marginTop: '4%' }} className='btn btn-primary'>Send message</button>\n        </form>\n\n        </div>\n    )\n\n});\n\n\n// Get content from database \ncontact.getInitialProps = async (ctx) =>{\n    console.log('ctx is');\n    console.log(ctx.query.bookOwnerID)\n    console.log(ctx.query.bookID)\n\n    try {\n\n        //const res = await fetch('https://unibooktrade.vercel.app/api/books', {\n            const res = await fetch('http://localhost:3000/api/books', {\n                headers: {\n                    title: '',\n                    author: '',\n                    id: ctx.query.bookOwnerID,\n                    bookID: ctx.query.bookID\n                }\n            });\n            const { data } = await res.json();\n        \n           \n           return{ books:data }\n           \n       } catch (error) {\n    \n        return { books: [] }\n           \n       }\n     \n }\n\nexport default contact;"]},"metadata":{},"sourceType":"module"}