{"ast":null,"code":"import mongoose from 'mongoose';\nconsole.log('inside dbConnect');\nconst connection = {}; //mongoose.set('useFindAndModify', false);\n\nconsole.log('Trying to connect to db.');\n\nasync function dbConnect() {\n  console.log('Above if statement.');\n\n  if (connection.isConnected) {\n    console.log('db on from first call');\n    return 1;\n  }\n\n  console.log('awaiting for db connection');\n  const db = await mongoose.connect(process.env.MONGO_URI, {//useNewUrlParser: true\n    //useUnifiedTopology: true\n  });\n\n  if (db.connections) {\n    console.log('\\nConnection exist');\n  } else {\n    console.log('no connections found');\n  }\n\n  connection.isConnected = db.connections[0].readyState;\n  console.log(connection.isConnected);\n  console.log('db is on.');\n\n  if (connection.isConnected) {\n    console.log('db on from second call');\n    return 1;\n  }\n}\n\nexport default dbConnect;","map":null,"metadata":{},"sourceType":"module"}